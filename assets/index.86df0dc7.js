var O=Object.defineProperty;var u=(t,s)=>O(t,"name",{value:s,configurable:!0});import{r as n}from"./index.6015db55.js";import{P as U,w as K,L as S,u as T,e as j}from"./motion.896eb0c0.js";import{b as v,s as B,u as G}from"./animate.aee8590b.js";import{j as m,F as P}from"./jsx-runtime.547177f5.js";function z(){const t=n.exports.useRef(!1);return v(()=>(t.current=!0,()=>{t.current=!1}),[]),t}u(z,"useIsMounted");function D(){const t=z(),[s,e]=n.exports.useState(0),r=n.exports.useCallback(()=>{t.current&&e(s+1)},[s]);return[n.exports.useCallback(()=>B.postRender(r),[r]),s]}u(D,"useForceUpdate");class L extends n.exports.Component{getSnapshotBeforeUpdate(s){const e=this.props.childRef.current;if(e&&s.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=e.offsetHeight||0,r.width=e.offsetWidth||0,r.top=e.offsetTop,r.left=e.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}u(L,"PopChildMeasure");function H({children:t,isPresent:s}){const e=n.exports.useId(),r=n.exports.useRef(null),x=n.exports.useRef({width:0,height:0,top:0,left:0});return n.exports.useInsertionEffect(()=>{const{width:d,height:a,top:c,left:R}=x.current;if(s||!r.current||!d||!a)return;r.current.dataset.motionPopId=e;const p=document.createElement("style");return document.head.appendChild(p),p.sheet&&p.sheet.insertRule(`
          [data-motion-pop-id="${e}"] {
            position: absolute !important;
            width: ${d}px !important;
            height: ${a}px !important;
            top: ${c}px !important;
            left: ${R}px !important;
          }
        `),()=>{document.head.removeChild(p)}},[s]),m(L,{isPresent:s,childRef:r,sizeRef:x,children:n.exports.cloneElement(t,{ref:r})})}u(H,"PopChild");const I=u(({children:t,initial:s,isPresent:e,onExitComplete:r,custom:x,presenceAffectsLayout:d,mode:a})=>{const c=G(V),R=n.exports.useId(),p=n.exports.useMemo(()=>({id:R,initial:s,isPresent:e,custom:x,onExitComplete:f=>{c.set(f,!0);for(const i of c.values())if(!i)return;r&&r()},register:f=>(c.set(f,!1),()=>c.delete(f))}),d?void 0:[e]);return n.exports.useMemo(()=>{c.forEach((f,i)=>c.set(i,!1))},[e]),n.exports.useEffect(()=>{!e&&!c.size&&r&&r()},[e]),a==="popLayout"&&(t=m(H,{isPresent:e,children:t})),m(U.Provider,{value:p,children:t})},"PresenceChild");function V(){return new Map}u(V,"newChildrenMap");const C=u(t=>t.key||"","getChildKey");function W(t,s){t.forEach(e=>{const r=C(e);s.set(r,e)})}u(W,"updateChildLookup");function Y(t){const s=[];return n.exports.Children.forEach(t,e=>{n.exports.isValidElement(e)&&s.push(e)}),s}u(Y,"onlyElements");const X=u(({children:t,custom:s,initial:e=!0,onExitComplete:r,exitBeforeEnter:x,presenceAffectsLayout:d=!0,mode:a="sync"})=>{x&&(a="wait",K(!1,"Replace exitBeforeEnter with mode='wait'"));let[c]=D();const R=n.exports.useContext(S).forceRender;R&&(c=R);const p=z(),f=Y(t);let i=f;const l=new Set,w=n.exports.useRef(i),g=n.exports.useRef(new Map).current,y=n.exports.useRef(!0);if(v(()=>{y.current=!1,W(f,g),w.current=i}),T(()=>{y.current=!0,g.clear(),l.clear()}),y.current)return m(P,{children:i.map(o=>m(I,{isPresent:!0,initial:e?void 0:!1,presenceAffectsLayout:d,mode:a,children:o},C(o)))});i=[...i];const E=w.current.map(C),M=f.map(C),b=E.length;for(let o=0;o<b;o++){const h=E[o];M.indexOf(h)===-1&&l.add(h)}return a==="wait"&&l.size&&(i=[]),l.forEach(o=>{if(M.indexOf(o)!==-1)return;const h=g.get(o);if(!h)return;const F=E.indexOf(o),$=u(()=>{g.delete(o),l.delete(o);const k=w.current.findIndex(A=>A.key===o);if(w.current.splice(k,1),!l.size){if(w.current=f,p.current===!1)return;c(),r&&r()}},"onExit");i.splice(F,0,m(I,{isPresent:!1,onExitComplete:$,custom:s,presenceAffectsLayout:d,mode:a,children:h},C(h)))}),i=i.map(o=>{const h=o.key;return l.has(h)?o:m(I,{isPresent:!0,presenceAffectsLayout:d,mode:a,children:o},C(o))}),j!=="production"&&a==="wait"&&i.length>1&&console.warn(`You're attempting to animate multiple children within AnimatePresence, but its mode is set to "wait". This will lead to odd visual behaviour.`),m(P,{children:l.size?i:i.map(o=>n.exports.cloneElement(o))})},"AnimatePresence");export{X as A,D as u};
//# sourceMappingURL=index.86df0dc7.js.map
